 <title>Wyrdbox Chat</title>
  <link rel="stylesheet" href="style.css">

  <!-- Firebase scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
</head>
@@ -18,27 +17,24 @@ <h1>Wyrdbox Chat</h1>
  <div id="chatbox"></div>

  <script>
    // --- Firebase setup ---
    // Firebase setup
    firebase.initializeApp({
      apiKey: "AIzaSyCqILLxx2JAxstJ9LRIiqgFDWUTvAx4ZVs",
      authDomain: "chatbox-3c95d.firebaseapp.com",
      projectId: "chatbox-3c95d",
      storageBucket: "chatbox-3c95d.appspot.com",
      storageBucket: "chatbox-3c95d.firebasestorage.app",
      messagingSenderId: "385714577506",
      appId: "1:385714577506:web:9308dc98ed8de92d00713b"
    });

    const db = firebase.firestore();

    // --- Determine user ---
    // Determine user
    let nickname = sessionStorage.getItem('nickname');
    if(!nickname) {
      // Not logged in / anonymous session not set
      window.location.href = 'welcome.html';
    }
    if(!nickname) window.location.href = 'welcome.html';
    document.getElementById('nickname').value = nickname;

    // --- Daily reset GMT-6 ---
    // Daily GMT-6 reset
    const now = new Date();
    const nowGMT6 = new Date(now.getTime() - (6 * 60 + now.getTimezoneOffset()) * 60000);
    const todayKey = nowGMT6.toISOString().split('T')[0];
@@ -51,12 +47,12 @@ <h1>Wyrdbox Chat</h1>
      localStorage.setItem('lastReset', todayKey);
    }

    // --- Send message ---
    // Send message
    function sendMessage() {
      const msg = document.getElementById('message').value;
      if(msg.trim() === "") return;

    db.collection("messages").add({
      db.collection("messages").add({
        nickname: nickname,
        text: msg,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
@@ -65,7 +61,7 @@ <h1>Wyrdbox Chat</h1>
      document.getElementById('message').value = "";
    }

    // --- Display messages ---
    // Display messages
    db.collection("messages").orderBy("timestamp")
      .onSnapshot(snapshot => {
        const chatbox = document.getElementById("chatbox");
@@ -74,7 +70,7 @@ <h1>Wyrdbox Chat</h1>
          const data = doc.data();
          chatbox.innerHTML += `<p><strong>${data.nickname}:</strong> ${data.text}</p>`;
        });
        chatbox.scrollTop = chatbox.scrollHeight; // scroll to latest
        chatbox.scrollTop = chatbox.scrollHeight;
      });
  </script>
</body>

